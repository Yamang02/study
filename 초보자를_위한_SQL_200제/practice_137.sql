/* 137. 세계에서 근무 시간이 가장 긴 나라는 어디인가? */

DROP TABLE WORKING_TIME;

CREATE  TABLE  WORKING_TIME
( COUNTRY      VARCHAR2(30),
  Y_2014       NUMBER(10),
  Y_2015       NUMBER(10),
  Y_2016       NUMBER(10),
  Y_2017       NUMBER(10),
  Y_2018       NUMBER(10) );
  
DROP VIEW C_WORK_TIME;

CREATE VIEW C_WORK_TIME
AS
SELECT *
  FROM WORKING_TIME
  UNPIVOT ( CNT FOR Y_YEAR IN ( Y_2014, Y_2015, Y_2016, Y_2017, Y_2018));

SELECT * FROM C_WORK_TIME;

/* 가장 일 많이하는 국가 */
SELECT COUNTRY, CNT, RANK() OVER (ORDER BY CNT DESC) 순위 FROM C_WORK_TIME WHERE Y_YEAR = 'Y_2018';